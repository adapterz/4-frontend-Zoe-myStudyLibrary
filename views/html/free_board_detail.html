<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>myStudyLibrary ììœ ê²Œì‹œíŒ</title>
    <style>
      @import url("/views/css/reset.css");
      @import url("/views/css/common.css");
      @import url("/views/css/free_board.css");
      @import url("/views/css/free_board_detail.css");
      /* ê¸€ì”¨ì²´ */
      @import url("https://fonts.googleapis.com/css2?family=Grape+Nuts&family=Gugi&family=Lobster&family=Noto+Sans+KR:wght@300&family=Noto+Serif+KR&family=Poor+Story&display=swap");
    </style>
  </head>
  <body>
    <!-- gmb -->
    <header>
      <script src="/views/js/header.js"></script>
    </header>
    <article class="freeBoard">
      <p class="freeBoard__title">ğŸ“‹ ììœ ê²Œì‹œíŒ</p>
      <nav class="freeBoard__board">
        <li>
          <p class="freeBoard__board--title"></p>
          <p class="freeBoard__user--profileImage">
            <img class="freeBoard__user--profileImageImg" src="/views/img/none_registered.png" alt="ìœ ì € ì‚¬ì§„ì…ë‹ˆë‹¤." />
          </p>
          <p class="freeBoard__user--nickname"></p>
          <p class="freeBoard__board--viewCount">
            <img class="freeBoard__board--img" src="/views/img/view.png" alt="ì¡°íšŒìˆ˜ ì•„ì´ì½˜" />123
          </p>
          <p class="freeBoard__board--favoriteCount">
            <img class="freeBoard__board--img" src="/views/img/love.png" alt="ì¢‹ì•„ìš” ì•„ì´ì½˜" />123
          </p>
          <p class="freeBoard__board--createDate"></p>
        </li>
      </nav>
      <p class="freeBoard__board--content"></p>
      <a href="" class="freeBoard__board--giveLove">
        <img src="/views/img/give-love.png" class="freeBoard__board--giveLoveImg" alt="ì¢‹ì•„ìš” +1"
      /></a>
      <section class="freeBoard__board--tags">
        <p class="freeBoard__board--tag"></p>
        <p class="freeBoard__board--tag"></p>
        <p class="freeBoard__board--tag"></p>
        <p class="freeBoard__board--tag"></p>
        <p class="freeBoard__board--tag"></p>
      </section>
      <section class="container__freeBoard--authorization">
        <button type="button" class="button__freeBoard--write">ê¸€ ìˆ˜ì •í•˜ê¸°</button>
        <button type="button" class="button__freeBoard--write">ê¸€ ì‚­ì œí•˜ê¸°</button>
      </section>
      <form action="" class="freeBoard__comment" method="post">
        <h2 class="freeBoard__comment--title">âœ ëŒ“ê¸€</h2>
        <nav class="freeBoard__comment"></nav>
        <input type="textarea" placeholder="ëŒ“ê¸€ ì…ë ¥" class="freeBoard__comment--input" name="content" />
        <input type="submit" value="ëŒ“ê¸€ì…ë ¥" class="freeBoard__comment--submit" />
      </form>
    </article>

    <!-- footer -->
    <footer class="footer__serviceInfo">
      <script src="/views/js/footer.js"></script>
    </footer>

    <!-- sweetAlert2 -->
    <script src="/views/js/sweetalert2.js" type="text/javascript"></script>
    <script src="/views/js/custom.js" type="text/javascript"></script>
    <!--fetch-->
    <script src="/customs/constant.js" type="text/javascript"></script>
    <script src="/models/board.js" type="text/javascript"></script>

    <script type="text/javascript">
      // íŠ¹ì • ê²Œì‹œê¸€ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°(ìµœì´ˆ 1ë²ˆ)
      async function detailBoard() {
        // url ì—ì„œ boardIndex ê°€ì ¸ì˜¤ê¸°
        const url = location.href;
        const urlArray = url.split(`${FRONT_URL}/board/`);
        const boardIndex = urlArray[1];
        console.log(boardIndex);
        const backendResult = await getDetailBoard(boardIndex);
        // í•´ë‹¹ ê²Œì‹œê¸€ì¸ë±ìŠ¤ì˜ ê²Œì‹œê¸€ì´ ì—†ì„ ë•Œ
        if (backendResult.state === NOT_EXIST) {
          const result = await sweetAlert(WARNING, "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²Œì‹œê¸€", "ê²Œì‹œê¸€ ëª©ë¡ìœ¼ë¡œ ì´ë™");
          if (result) {
            location.href = "/board";
          }
          // ì„±ê³µì ìœ¼ë¡œ ê°œì‹œê¸€ ì •ë³´ ë¶ˆëŸ¬ì™”ì„ ë•Œ
        } else if (backendResult.state === REQUEST_SUCCESS) {
          // ê²Œì‹œê¸€ ì •ë³´ ë°°ì¹˜
          document.getElementsByClassName(
            "freeBoard__board--title"
          )[0].innerHTML = `${backendResult.dataOfBoard.postTitle}`;
          document.getElementsByClassName(
            "freeBoard__board--viewCount"
          )[0].innerHTML = `<img class="freeBoard__board--img" src="/views/img/view.png" alt="ì¡°íšŒìˆ˜ ì•„ì´ì½˜" /> ${backendResult.dataOfBoard.viewCount}`;
          document.getElementsByClassName(
            "freeBoard__board--favoriteCount"
          )[0].innerHTML = `<img class="freeBoard__board--img" src="/views/img/love.png" alt="ì¢‹ì•„ìš” ì•„ì´ì½˜" /> ${backendResult.dataOfBoard.favoriteCount}`;
          document.getElementsByClassName(
            "freeBoard__board--content"
          )[0].innerHTML = `${backendResult.dataOfBoard.postContent}`;
        }

        // íƒœê·¸ ë°°ì¹˜
        const length = backendResult.dataOfTag.length;
        for (let cnt = 0; cnt < 5; ++cnt) {
          if (cnt >= length) document.getElementsByClassName("freeBoard__board--tag")[cnt].style.display = "none";
          else {
            document.getElementsByClassName("freeBoard__board--tag")[
              cnt
            ].innerHTML = `# ${backendResult.dataOfTag[cnt].tag}`;
          }
        }
        // ìœ ì € ì •ë³´ ë°°ì¹˜
        document.getElementsByClassName(
          "freeBoard__user--nickname"
        )[0].innerHTML = `${backendResult.dataOfUser.nickname}`;
        // ìœ ì €ì—ê²Œ ë“±ë¡ëœ í”„ë¡œí•„ ì‚¬ì§„ì´ ìˆì„ ë•Œ
        if (backendResult.dataOfUser.isProfileImage) {
          const image = backendResult.dataOfUser.profileImage;
          const mime = backendResult.dataOfUser.mime;
          const imageHTML = document.getElementsByClassName("freeBoard__user--profileImage")[0];
          imageHTML.innerHTML = `<img class="freeBoard__user--profileImageImg" src="data:${mime};base64,${image}">`;
        }
      }
      detailBoard();
    </script>
  </body>
</html>
