<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="/data/constant.js"></script>
    <script src="/data/cookie.js" type="text/javascript"></script>
    <script src="/data/user.js" type="text/javascript"></script>
    <script src="/data/board.js" type="text/javascript"></script>
    <script src="/data/wise_saying.js" type="text/javascript"></script>
    <style>
      @import url("/views/css/reset.css");
      @import url("/views/css/common.css");
      @import url("/views/css/home.css");
      /* ê¸€ì”¨ì²´ */
      @import url("https://fonts.googleapis.com/css2?family=Grape+Nuts&family=Gugi&family=Lobster&family=Noto+Sans+KR:wght@300&family=Noto+Serif+KR&family=Poor+Story&display=swap");
    </style>
    <script>
      // ë¡œê·¸ì¸ ì²´í¬ í•„ìš”(ìµœì´ˆ í•œë²ˆ ì²´í¬)
      async function checkLogin() {
        const result = await getUserInfo();
        // ë¡œê·¸ì¸ ì•ˆí–ˆì„ ë•Œ ë¡œê·¸ì¸ ì°½ ìˆëŠ” í™ˆí˜ì´ì§€ë¡œ
        if (result.state === LOGIN_REQUIRED) {
          location.href = "/";
        }
      }
      checkLogin();
      // ë¡œê·¸ì•„ì›ƒ
      async function logout() {
        const result = await reqLogout();
        if (result.state === LOGOUT) {
          location.href = "/";
        }
        alert(result.state);
      }
      // ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      async function page() {
        // ìµœê·¼ ê²Œì‹œíŒ ì •ë³´
        const boardResult = await getRecentBoard();
        // ìµœê·¼ ê²Œì‹œíŒ ì •ë³´ íŒŒì‹±
        for (let num in boardResult) {
          document.getElementsByClassName("home__board--title")[num].innerHTML = `${boardResult[num].postTitle}`;
          document.getElementsByClassName("home__board--nickname")[
            num
          ].innerHTML = `ì‘ì„±ì: ${boardResult[num].nickname}`;
        }
        // ëª…ì–¸ ì •ë³´
        const wiseSayingResult = await getWiseSaying();
        // ëª…ì–¸ ì •ë³´ íŒŒì‹±
        document.getElementsByClassName("home__wiseSaying--content")[0].innerHTML = wiseSayingResult.wiseSayingContent;
        document.getElementsByClassName("home__wiseSaying--celebrity")[0].innerHTML = wiseSayingResult.celebrity;

        // ìœ ì € ì •ë³´
        const userResult = await getUserInfo();
        document.getElementsByClassName("home__user--nickname")[0].innerHTML = `${userResult.nickname}ë‹˜`;
        // ë“±ë¡ëœ í”„ë¡œí•„ ì‚¬ì§„ì´ ìˆì„ ë•Œ í”„ë¡œí•„ ì‚¬ì§„ ì •ë³´ ì£¼ê¸°
        if (userResult.isProfileImage) {
          const image = userResult.profileImage;
          const mime = userResult.mime;
          const imageHTML = document.getElementsByClassName("home__user--profileImage")[0];
          imageHTML.innerHTML = `<img class="home__user--profileImageImg" src="data:${mime};base64,${image} ">`;
        }
      }
      page();
    </script>
    <title>myStudyLibrary í™ˆí˜ì´ì§€</title>
  </head>
  <body>
    <!-- ë§¨ ìœ„ì— ë©”ë‰´ë°” -->
    <nav class="gmb">
      <!-- ë¡œê³  -->
      <a href="/">
        <div class="gmb__logo">
          <img class="gmb__logo--img" src="/views/img/logo.png" alt="ì„œë¹„ìŠ¤ ë¡œê³ ì…ë‹ˆë‹¤." />
          myStudyLibrary
        </div>
      </a>
      <!-- ë©”ë‰´ -->
      <ul class="gmb__menu">
        <li><a href="">ì£¼ë³€ë„ì„œê´€</a></li>
        <li><a href="">ììœ ê²Œì‹œíŒ</a></li>
        <li><a href="">ë‚´ê°€ì‘ì„±í•œê¸€</a></li>
      </ul>
    </nav>
    <main class="home">
      <!-- ë°°ê²½ì‚¬ì§„ -->
      <section class="home__card">
        <img class="home__card--img" src="/views/img/home.png" alt="í™ˆí˜ì´ì§€ ë©”ì¸ ë°°ê²½í™”ë©´ì…ë‹ˆë‹¤." />
      </section>
      <!-- ìœ ì € ì •ë³´ -->
      <section class="home__user--logined">
        <!-- ìœ ì €ê°€ ì‚¬ì§„ë“±ë¡ì•ˆí–ˆì„ ë•Œ -->
        <p class="home__user--profileImage">
          <img class="home__user--profileImageImg" src="/views/img/none_registered.png" alt="ìœ ì € ì‚¬ì§„ì…ë‹ˆë‹¤." />
        </p>
        <p class="home__user--nickname">ìœ ì € ë‹‰ë„¤ì„</p>
        <button type="button" class="button__user">ìœ ì €ì •ë³´</button>
        <button type="button" class="button__logout" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
      </section>
      <!-- ììœ ê²Œì‹œíŒ-ìµœê·¼ê²Œì‹œê¸€ -->
      <article class="home__board">
        <p class="home__category">ğŸ“‹ ììœ ê²Œì‹œíŒ - ìµœì‹ ê¸€</p>
        <nav>
          <li>
            <a href=""
              ><p class="home__board--title">ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”!</p>
              <p class="home__board--nickname">ê¸€ì´ ì‘ì„±ë˜ì§€ ì•Šì•˜ì–´ìš” :)</p></a
            >
          </li>
          <li>
            <a href=""
              ><p class="home__board--title">ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”!</p>
              <p class="home__board--nickname">ê¸€ì´ ì‘ì„±ë˜ì§€ ì•Šì•˜ì–´ìš” :)</p></a
            >
          </li>
          <li>
            <a href=""
              ><p class="home__board--title">ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”!</p>
              <p class="home__board--nickname">ê¸€ì´ ì‘ì„±ë˜ì§€ ì•Šì•˜ì–´ìš” :)</p></a
            >
          </li>
          <li>
            <a href=""
              ><p class="home__board--title">ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”!</p>
              <p class="home__board--nickname">ê¸€ì´ ì‘ì„±ë˜ì§€ ì•Šì•˜ì–´ìš” :)</p></a
            >
          </li>
          <li>
            <a href=""
              ><p class="home__board--title">ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”!</p>
              <p class="home__board--nickname">ê¸€ì´ ì‘ì„±ë˜ì§€ ì•Šì•˜ì–´ìš” :)</p></a
            >
          </li>
        </nav>
      </article>
      <!-- ë™ê¸°ë¶€ì—¬ìš© ëª…ì–¸ -->
      <article class="home__wiseSaying">
        <nav>
          <p class="home__category">ğŸ’ª ë™ê¸°ë¶€ì—¬</p>
          <li class="home__wiseSaying--content">
            ëª…ì–¸ ì˜ˆì‹œ
          </li>
          <li class="home__wiseSaying--celebrity">- Zoe -</li>
        </nav>
      </article>
    </main>
    <!-- footer -->
    <footer class="footer__serviceInfo">
      (ì£¼) myStudyLibrary
      <br />
      <pre> ëŒ€í‘œ: ê¹€ì˜ˆì§€</pre>
      <br />
    </footer>
  </body>
</html>
